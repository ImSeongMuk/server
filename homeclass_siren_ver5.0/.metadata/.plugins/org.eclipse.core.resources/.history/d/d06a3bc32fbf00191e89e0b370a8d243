<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="dealim.cs.siren.mappers.testMapper">

	<!-- 
        mybatis-config.xml의 typeAlias에 등록해두지 않았다면 
        <select id="selectMember" resultType="com.example.dto.MemberVO" >
            SELECT ID, PW ,NAME FROM TEST
        </select>
        
        이렇게 해야 한다.
    -->
    <!--보호자 삭제 -->
    <delete id = "protectDelete">
   	 	delete from detail
		where userNum = #{userNum} and detailCode =#{detailCode};
    </delete>
    <!--보호자 수정 -->
    <update id="protectUpdate">
		update detail set 
		diseaseName = #{diseaseName} , detailContent = #{detailContent}
		where userNum = #{userNum} and detailCode = #{detailCode};
	</update>
    <!--보호자 추가 -->
    <insert id="protectInsert">
	     insert into detail(userNum,diseaseName,detailContent)
	     values(#{userNum},#{diseaseName},#{detailContent});
	</insert>
    <!--보호자  select-->
    <select id = 'protectInfo' resultType="ProtectorTel">
		select * 
		from detail
		where userNum = #{userNum};
    </select>
    
    <!--디테일 삭제 -->
    <delete id = "detailDelete">
   	 	delete from detail
		where userNum = #{userNum} and detailCode =#{detailCode};
    </delete>
    <!--디테일 수정 -->
    <update id="detailUpdate">
		update detail set 
		diseaseName = #{diseaseName} , detailContent = #{detailContent}
		where userNum = #{userNum} and detailCode = #{detailCode};
	</update>
    <!--디테일 추가 -->
    <insert id="detailInsert">
	     insert into detail(userNum,diseaseName,detailContent)
	     values(#{userNum},#{diseaseName},#{detailContent});
	</insert>
    <!--디테일  select-->
    <select id = 'detailInfo' resultType="Detail">
		select * 
		from detail
		where userNum = #{userNum};
    </select>
    <!--약 리스트 -->
    <select id = 'userMedicine' resultType="MedicineConn">
		select mc.userNum,mc.diseaseCode,d.disease,mc.medicineCode,m.medicine
		from medicineConn mc, medicine m ,disease d 
		where mc.medicineCode=m.medicineCode and mc.userNum = #{userNum} and mc.diseaseCode = #{diseaseCode} and d.diseaseCode = mc.diseaseCode ;
		
    </select>
    <!--병 리스트 -->
    <select id = 'userDisease' resultType="DiseaseConn">
    	 select dc.userNum,d.diseaseCode,d.disease
		 from diseaseConn dc, disease d
		 where d.diseaseCode = dc.diseaseCode and dc.userNum = #{userNum};
    </select>
    
	<select id='user_db' resultType="Userinfo">
		 select * from userinfo;
	</select>
	
	<insert id="user_insert">
	     insert into userinfo(email,name,phone,password,birth,hospital)
	     values(#{email},#{name},#{phone},#{password},#{birth},#{hospital});
	</insert>
	
	<select id='user_login' resultType="Userinfo">
		 select * from userinfo where email = #{email} and password = #{password};
	</select>
	
	<select id='userinfo' resultType="Userinfo">
		 select * from userinfo where email = #{email};
	</select>
	
	<select id='emailoverlap' resultType="Userinfo">
		 select * from userinfo where email = #{email};
	</select>
	
	<update id="update_detail">
		update userinfo set disease1 = #{disease1},
		disease2 = #{disease2}, disease3 = #{disease3}, disease4 = #{disease4}, disease5 = #{disease5},
		medicine1 = #{medicine1}, medicine2 = #{medicine2}, medicine3 = #{medicine3}, medicine4 = #{medicine4}, medicine5 = #{medicine5},
		weight = #{weight},
		hospital = #{hospital},
		around1 = #{around1}, around2 = #{around2}, around3 = #{around3}, around4 = #{around4}, around5 = #{around5} where email = #{email};
	</update>
	
	<update id="email_send">
		update userinfo set 
			password = #{password} 
		where email = #{email} and birth = #{birth};
	</update>
	
	
	
</mapper>